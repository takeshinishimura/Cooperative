<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>データの整形</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="08_data_formatting_files/libs/clipboard/clipboard.min.js"></script>
<script src="08_data_formatting_files/libs/quarto-html/quarto.js"></script>
<script src="08_data_formatting_files/libs/quarto-html/popper.min.js"></script>
<script src="08_data_formatting_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="08_data_formatting_files/libs/quarto-html/anchor.min.js"></script>
<link href="08_data_formatting_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="08_data_formatting_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="08_data_formatting_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="08_data_formatting_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="08_data_formatting_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#e-statからデータ取得" id="toc-e-statからデータ取得" class="nav-link active" data-scroll-target="#e-statからデータ取得"><span class="header-section-number">1</span> e-Statからデータ取得</a></li>
  <li><a href="#データ整形" id="toc-データ整形" class="nav-link" data-scroll-target="#データ整形"><span class="header-section-number">2</span> データ整形</a>
  <ul class="collapse">
  <li><a href="#データフレームの列" id="toc-データフレームの列" class="nav-link" data-scroll-target="#データフレームの列"><span class="header-section-number">2.1</span> データフレームの列</a></li>
  <li><a href="#データフレームの列間関係" id="toc-データフレームの列間関係" class="nav-link" data-scroll-target="#データフレームの列間関係"><span class="header-section-number">2.2</span> データフレームの列間関係</a></li>
  <li><a href="#データフレームの整形" id="toc-データフレームの整形" class="nav-link" data-scroll-target="#データフレームの整形"><span class="header-section-number">2.3</span> データフレームの整形</a></li>
  </ul></li>
  <li><a href="#作図" id="toc-作図" class="nav-link" data-scroll-target="#作図"><span class="header-section-number">3</span> 作図</a>
  <ul class="collapse">
  <li><a href="#折れ線グラフの作図" id="toc-折れ線グラフの作図" class="nav-link" data-scroll-target="#折れ線グラフの作図"><span class="header-section-number">3.1</span> 折れ線グラフの作図</a></li>
  <li><a href="#もっと作図" id="toc-もっと作図" class="nav-link" data-scroll-target="#もっと作図"><span class="header-section-number">3.2</span> もっと作図</a></li>
  <li><a href="#もっともっと作図" id="toc-もっともっと作図" class="nav-link" data-scroll-target="#もっともっと作図"><span class="header-section-number">3.3</span> もっともっと作図</a></li>
  </ul></li>
  <li><a href="#都道府県別の作図" id="toc-都道府県別の作図" class="nav-link" data-scroll-target="#都道府県別の作図"><span class="header-section-number">4</span> 都道府県別の作図</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">データの整形</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>ここでは，農業協同組合の組合員数の推移の把握を試みます。</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
農業協同組合及び同連合会一斉調査 確報 総合農協統計表
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://www.e-stat.go.jp/dbview?sid=0003406360" target="_blank">https://www.e-stat.go.jp/dbview?sid=0003406360</a></p>
</div>
</div>
</div>
<p>これまで，e-Statから取得したデータをグラフにするまで，何の迷いもなくRのコードを書いているかのように，説明してきました。 しかし実際には，図をどう描くか考える前に，データがどのような構造になっているのかを調べ，試行錯誤しています。 ここでは，統計データを取得した後，そのデータの構造を確認しながら，データを整形していく方法を紹介します。</p>
<section id="e-statからデータ取得" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="e-statからデータ取得"><span class="header-section-number">1</span> e-Statからデータ取得</h2>
<p>次のコードを実行し，欲しいデータを取得しましょう。 次のコードにある <code>statsDataId = "0003406360"</code> の数字はアクセスしたい統計データのIDです。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estatapi)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>このサービスは、政府統計総合窓口(e-Stat)のAPI機能を使用していますが、サービスの内容は国によって保証されたものではありません。</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>appId <span class="ot">&lt;-</span> keyring<span class="sc">::</span><span class="fu">key_get</span>(<span class="st">"e-stat"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>statsDataId <span class="ot">&lt;-</span> <span class="st">"0003406360"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>(meta_info <span class="ot">&lt;-</span> <span class="fu">estat_getMetaInfo</span>(<span class="at">appId =</span> appId, <span class="at">statsDataId =</span> statsDataId))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cat01
# A tibble: 27 × 5
   `@code` `@name`                               `@level` `@unit` `@parentCode`
   &lt;chr&gt;   &lt;chr&gt;                                 &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;        
 1 110     合計_計                               1        人      &lt;NA&gt;         
 2 120     合計_個人                             2        人      110          
 3 130     合計_団体                             2        人      110          
 4 150     正組合員_計                           2        人      110          
 5 160     正組合員_個人                         3        人      150          
 6 170     正組合員_個人_女性                    4        人      160          
 7 180     正組合員_個人_組合員たる地位を失わな… 4        人      160          
 8 190     正組合員_法人                         3        人      150          
 9 200     正組合員_法人_農事組合法人            4        人      190          
10 210     正組合員_法人_その他法人              4        人      190          
# ℹ 17 more rows

$area
# A tibble: 56 × 4
   `@code` `@name`     `@level` `@parentCode`
   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;        
 1 00000   全国        1        &lt;NA&gt;         
 2 00200   1組合当たり 1        &lt;NA&gt;         
 3 01000   北海道      2        00000        
 4 01100   東北_小計   2        00000        
 5 02000   青森県      3        01100        
 6 03000   岩手県      3        01100        
 7 04000   宮城県      3        01100        
 8 05000   秋田県      3        01100        
 9 06000   山形県      3        01100        
10 07000   福島県      3        01100        
# ℹ 46 more rows

$time
# A tibble: 19 × 3
   `@code`    `@name`  `@level`
   &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;   
 1 2016100000 2016年度 1       
 2 2015100000 2015年度 1       
 3 2014100000 2014年度 1       
 4 2013100000 2013年度 1       
 5 2012100000 2012年度 1       
 6 2011100000 2011年度 1       
 7 2010100000 2010年度 1       
 8 2009100000 2009年度 1       
 9 2008100000 2008年度 1       
10 2007100000 2007年度 1       
11 2006100000 2006年度 1       
12 2005100000 2005年度 1       
13 2004100000 2004年度 1       
14 2003100000 2003年度 1       
15 2002100000 2002年度 1       
16 2001100000 2001年度 1       
17 2000100000 2000年度 1       
18 1999100000 1999年度 1       
19 1998100000 1998年度 1       

$.names
# A tibble: 3 × 2
  id    name            
  &lt;chr&gt; &lt;chr&gt;           
1 cat01 組合員別内訳    
2 area  都道府県        
3 time  時間軸（年度次）</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 統計データ取得</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">estat_getStatsData</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">appId =</span> appId,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">statsDataId =</span> statsDataId</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Fetching record 1-14009... (total: 14009 records)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14,009 × 9
   cat01_code 組合員別内訳 area_code 都道府県 time_code `時間軸（年度次）` unit 
   &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;              &lt;chr&gt;
 1 110        合計_計      00000     全国     20161000… 2016年度           人   
 2 110        合計_計      00000     全国     20151000… 2015年度           人   
 3 110        合計_計      00000     全国     20141000… 2014年度           人   
 4 110        合計_計      00000     全国     20131000… 2013年度           人   
 5 110        合計_計      00000     全国     20121000… 2012年度           人   
 6 110        合計_計      00000     全国     20111000… 2011年度           人   
 7 110        合計_計      00000     全国     20101000… 2010年度           人   
 8 110        合計_計      00000     全国     20091000… 2009年度           人   
 9 110        合計_計      00000     全国     20081000… 2008年度           人   
10 110        合計_計      00000     全国     20071000… 2007年度           人   
# ℹ 13,999 more rows
# ℹ 2 more variables: value &lt;dbl&gt;, annotation &lt;chr&gt;</code></pre>
</div>
</div>
<p>このデータはどういう構造になっているのか想像できない。 そこで，データの構造を詳細に確認してみる。</p>
</section>
<section id="データ整形" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="データ整形"><span class="header-section-number">2</span> データ整形</h2>
<p>データの構造を確認するには，次のコマンドを実行するとよいでしょう。 先頭のみを表示します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  cat01_code 組合員別内訳 area_code 都道府県 time_code  `時間軸（年度次）` unit 
  &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;              &lt;chr&gt;
1 110        合計_計      00000     全国     2016100000 2016年度           人   
2 110        合計_計      00000     全国     2015100000 2015年度           人   
3 110        合計_計      00000     全国     2014100000 2014年度           人   
4 110        合計_計      00000     全国     2013100000 2013年度           人   
5 110        合計_計      00000     全国     2012100000 2012年度           人   
6 110        合計_計      00000     全国     2011100000 2011年度           人   
# ℹ 2 more variables: value &lt;dbl&gt;, annotation &lt;chr&gt;</code></pre>
</div>
</div>
<p>先頭の全体を表示したい場合は，<code>tibble</code> は不向きです。 不便だと思ったら，<code>data.frame</code> に変換するとよいでしょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">head</span>(df))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cat01_code 組合員別内訳 area_code 都道府県  time_code 時間軸.年度次. unit
1        110      合計_計     00000     全国 2016100000       2016年度   人
2        110      合計_計     00000     全国 2015100000       2015年度   人
3        110      合計_計     00000     全国 2014100000       2014年度   人
4        110      合計_計     00000     全国 2013100000       2013年度   人
5        110      合計_計     00000     全国 2012100000       2012年度   人
6        110      合計_計     00000     全国 2011100000       2011年度   人
     value annotation
1 10444426       &lt;NA&gt;
2 10370172       &lt;NA&gt;
3 10267614       &lt;NA&gt;
4 10145363       &lt;NA&gt;
5  9977967       &lt;NA&gt;
6  9834031       &lt;NA&gt;</code></pre>
</div>
</div>
<p>データの最後の部分のみを表示します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  cat01_code 組合員別内訳  area_code 都道府県 time_code `時間軸（年度次）` unit 
  &lt;chr&gt;      &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;              &lt;chr&gt;
1 380        一戸複数正組… 47000     沖縄県   20081000… 2008年度           組合 
2 380        一戸複数正組… 47000     沖縄県   20071000… 2007年度           組合 
3 380        一戸複数正組… 47000     沖縄県   20061000… 2006年度           組合 
4 380        一戸複数正組… 47000     沖縄県   20051000… 2005年度           組合 
5 380        一戸複数正組… 47000     沖縄県   20041000… 2004年度           組合 
6 380        一戸複数正組… 47000     沖縄県   20031000… 2003年度           組合 
# ℹ 2 more variables: value &lt;dbl&gt;, annotation &lt;chr&gt;</code></pre>
</div>
</div>
<p>データの次元（列数とレコード数）を確認します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14009     9</code></pre>
</div>
</div>
<p>データの構造を確認します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [14,009 × 9] (S3: tbl_df/tbl/data.frame)
 $ cat01_code      : chr [1:14009] "110" "110" "110" "110" ...
 $ 組合員別内訳    : chr [1:14009] "合計_計" "合計_計" "合計_計" "合計_計" ...
 $ area_code       : chr [1:14009] "00000" "00000" "00000" "00000" ...
 $ 都道府県        : chr [1:14009] "全国" "全国" "全国" "全国" ...
 $ time_code       : chr [1:14009] "2016100000" "2015100000" "2014100000" "2013100000" ...
 $ 時間軸（年度次）: chr [1:14009] "2016年度" "2015年度" "2014年度" "2013年度" ...
 $ unit            : chr [1:14009] "人" "人" "人" "人" ...
 $ value           : num [1:14009] 10444426 10370172 10267614 10145363 9977967 ...
 $ annotation      : chr [1:14009] NA NA NA NA ...</code></pre>
</div>
</div>
<p>まず，「都道府県」の列に「全国」があるのが確認できます。 最初は，<code>"全国"</code> の行だけ抽出することに決め。都道府県別については後回しにすることにします。 こうしたデータ抽出の判断は，人間が行わなければなりません。</p>
<p>データフレームのそれぞれの列にどういう値が入っているか確認するには，文字列型の場合，<code>table()</code> または <code>unique()</code> を使えばよいです。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>都道府県)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1組合当たり          愛知県          愛媛県          茨城県          岡山県 
            249             249             249             249             249 
         沖縄県       関東_小計          岩手県          岐阜県          宮崎県 
            249             249             249             249             249 
         宮城県          京都府       近畿_小計       九州_小計          熊本県 
            249             249             249             249             249 
         群馬県          広島県          香川県          高知県          佐賀県 
            249             249             249             249             249 
         埼玉県          三重県          山形県          山口県          山梨県 
            249             249             249             249             249 
         滋賀県        鹿児島県          秋田県          新潟県        神奈川県 
            249             249             249             249             249 
         青森県          静岡県          石川県          千葉県            全国 
            249             249             249             249             314 
         大阪府          大分県 中国・四国_小計          長崎県          長野県 
            249             249             249             249             249 
         鳥取県          島根県       東海_小計          東京都       東北_小計 
            249             249             249             249             249 
         徳島県          栃木県          奈良県          富山県          福井県 
            249             249             249             249             249 
         福岡県          福島県          兵庫県          北海道       北陸_小計 
            249             249             249             249             249 
       和歌山県 
            249 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df<span class="sc">$</span>都道府県)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "全国"            "1組合当たり"     "北海道"          "東北_小計"      
 [5] "青森県"          "岩手県"          "宮城県"          "秋田県"         
 [9] "山形県"          "福島県"          "関東_小計"       "茨城県"         
[13] "栃木県"          "群馬県"          "埼玉県"          "千葉県"         
[17] "東京都"          "神奈川県"        "山梨県"          "長野県"         
[21] "静岡県"          "北陸_小計"       "新潟県"          "富山県"         
[25] "石川県"          "福井県"          "東海_小計"       "岐阜県"         
[29] "愛知県"          "三重県"          "近畿_小計"       "滋賀県"         
[33] "京都府"          "大阪府"          "兵庫県"          "奈良県"         
[37] "和歌山県"        "中国・四国_小計" "鳥取県"          "島根県"         
[41] "岡山県"          "広島県"          "山口県"          "徳島県"         
[45] "香川県"          "愛媛県"          "高知県"          "九州_小計"      
[49] "福岡県"          "佐賀県"          "長崎県"          "熊本県"         
[53] "大分県"          "宮崎県"          "鹿児島県"        "沖縄県"         </code></pre>
</div>
</div>
<p><code>table()</code> と <code>unique()</code> は似た結果が出力されます。 <code>table()</code> からはそれぞれのレコード数が分かり，<code>unique()</code> からは表にある順番が分かります。</p>
<p>ここでは，<code>"全国"</code> だけで 314 もある。</p>
<section id="データフレームの列" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="データフレームの列"><span class="header-section-number">2.1</span> データフレームの列</h3>
<p>ここでデータフレームの列の指定方法について，簡単に説明しておきます。 最も簡単かつ短い書き方は次のとおりです。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>都道府県</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ただし，日本語の列名をそのまま使うのは不安です。 例えば，次のようにするとエラーが出ます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>時間軸（年度次）</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>なぜでしょうか。 Rを使い慣れている人だとこの種のエラーへの対策は分かるはずです。 例えば，データフレームがこの列名を変えたがることに気づいたことがあるでしょう。 そう，<code>data.frame()</code> で指定する <code>check.names =</code> はこうした問題に対応するための引数です。</p>
<p>こうしたエラーの回避策はあります。 次のようにするとエラーが出ず，欲しい結果が得られます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span><span class="st">`</span><span class="at">時間軸（年度次）</span><span class="st">`</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ただし，こういった書き方をするくらいであれば，<code>df[, "時間軸（年度次）"]</code> といった表記に統一した方がスマートではないでしょうか。 しかし，この表記はtidyverse（tibble）的には好ましくないようである。 base Rでは，[]内がスカラー（1次元）なら返り値はベクトルで，[]内がベクトル（2次元以上）なら返り値はデータフレームです。 tibbleの場合，[]内が何であれ，返り値はtibbleになるようです。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df[, <span class="st">"時間軸（年度次）"</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(df, <span class="at">check.names =</span> <span class="cn">FALSE</span>)[, <span class="st">"時間軸（年度次）"</span>]</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="データフレームの列間関係" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="データフレームの列間関係"><span class="header-section-number">2.2</span> データフレームの列間関係</h3>
<p><code>head(df)</code>の返り値を詳細に見てみましょう。 <code>area_code</code> が <code>"00000"</code> である行は，<code>"全国"</code> に対応していることが想像できます。 本当にそうなっているか，確認してみましょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>area_code, df<span class="sc">$</span>都道府県)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>このようにしてもよいですが，出力が大きすぎるため，ピンポイントで結果が得られるコードを書く必要があります。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>area_code[df<span class="sc">$</span>都道府県 <span class="sc">==</span> <span class="st">"全国"</span>])</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
00000 
  314 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df[df<span class="sc">$</span>都道府県 <span class="sc">!=</span> <span class="st">"全国"</span> <span class="sc">&amp;</span> df<span class="sc">$</span>area_code <span class="sc">==</span> <span class="st">"00000"</span>, ]</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 9
# ℹ 9 variables: cat01_code &lt;chr&gt;, 組合員別内訳 &lt;chr&gt;, area_code &lt;chr&gt;,
#   都道府県 &lt;chr&gt;, time_code &lt;chr&gt;, 時間軸（年度次） &lt;chr&gt;, unit &lt;chr&gt;,
#   value &lt;dbl&gt;, annotation &lt;chr&gt;</code></pre>
</div>
</div>
<p>次に，<code>時間軸（年度次）</code> 列がそのまま年度が入力されていることが創造できます。 そして，<code>"2016年度"</code>，<code>"2015年度"</code>，<code>"2014年度"</code> といったように文字列となっていることから，<code>"年度"</code> を削除して，数値型に変換する必要があることまで見通せます。 一方，<code>time_code</code> 列は，<code>"2016100000"</code>，<code>"2015100000"</code>，<code>"2014100000"</code> という値が入っており，文字列です。 これが <code>時間軸（年度次）</code> 列と同じ情報かどうかは，これだけでは分かりません。 <code>"2016"</code> に続く <code>"100000"</code> の数字は何を意味するのでしょうか。 <code>time_code</code> 列を確認してみます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>time_code)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1998100000 1999100000 2000100000 2001100000 2002100000 2003100000 2004100000 
        13         13         13         13         13        728        728 
2005100000 2006100000 2007100000 2008100000 2009100000 2010100000 2011100000 
       728        728       1176       1176       1176       1176       1008 
2012100000 2013100000 2014100000 2015100000 2016100000 
      1064       1064       1064       1064       1064 </code></pre>
</div>
</div>
<p><code>time_code</code> 列の値の後半部分 <code>"100000"</code> は，ここでは意味がなく，<code>sub()</code> で削除してもよいことが創造できます。 それでは，<code>time_code</code> 列は <code>時間軸（年度次）</code> 列と1対1で対応しているでしょうか。 すなわち，<code>時間軸（年度次）</code> 列から<code>"年度"</code> を取り除いた値と<code>time_code</code> 列から<code>"100000"</code>を取り除いた値は一致するでしょうか。 これを確認する方法は多くあります。 例えば，次のようにします。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">apply</span>(df[, <span class="fu">c</span>(<span class="st">"time_code"</span>, <span class="st">"時間軸（年度次）"</span>)], <span class="dv">1</span>, paste, <span class="at">collapse =</span> <span class="st">" "</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1998100000 1998年度 1999100000 1999年度 2000100000 2000年度 2001100000 2001年度 
                 13                  13                  13                  13 
2002100000 2002年度 2003100000 2003年度 2004100000 2004年度 2005100000 2005年度 
                 13                 728                 728                 728 
2006100000 2006年度 2007100000 2007年度 2008100000 2008年度 2009100000 2009年度 
                728                1176                1176                1176 
2010100000 2010年度 2011100000 2011年度 2012100000 2012年度 2013100000 2013年度 
               1176                1008                1064                1064 
2014100000 2014年度 2015100000 2015年度 2016100000 2016年度 
               1064                1064                1064 </code></pre>
</div>
</div>
<p>ただし，この方法では結果をいちいち確認しなければなりません。 できれば，<code>TRUE</code> で返ってくるかどうかで判断したいです。 もしそうなら，次のようにすればよいです。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">sub</span>(<span class="st">"年度"</span>, <span class="st">""</span>, df<span class="sc">$</span><span class="st">`</span><span class="at">時間軸（年度次）</span><span class="st">`</span>) <span class="sc">==</span> <span class="fu">sub</span>(<span class="st">"100000$"</span>, <span class="st">""</span>, df<span class="sc">$</span>time_code))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 TRUE 
14009 </code></pre>
</div>
</div>
<p>年度の入力ミスはなさそうなので，どちらの列でもよく，今回は <code>時間軸（年度次）</code> 列から年度の数値が得られることが分かります。</p>
<p><code>str(df)</code>の返り値について，他の列について見ておきましょう。 <code>unit</code> 列は単位であり作図には使いませんが，数値の意味を確認する際に参照することを覚えておきます。 <code>value</code> は数値です。 この表はロングであるため，<code>ggplot2</code> として作図するのに扱いやすいです。</p>
</section>
<section id="データフレームの整形" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="データフレームの整形"><span class="header-section-number">2.3</span> データフレームの整形</h3>
<p>これまででデータの構造がおおよそ把握できました。 ここで，データを扱いやすくなるように変更します。</p>
<p>その際，元のデータフレームは残したまま，新しいデータフレームを作成するようにしましょう。 以降は新しいデータフレームで作業し，もし間違った場合は，ここに戻ってくれば最初からやり直さずににすむためです。</p>
<p>まず，全国のみのデータを抽出してもよいですが，後で都道府県別のデータを扱うときに手間をかけないようにするために，全国のみのデータにするのは最後にしましょう。 それ以外の整形をまずやります。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>年度 <span class="ot">&lt;-</span> <span class="fu">as.double</span>(<span class="fu">sub</span>(<span class="st">"年度"</span>, <span class="st">""</span>, df2<span class="sc">$</span><span class="st">`</span><span class="at">時間軸（年度次）</span><span class="st">`</span>))</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 必要な列のみ抽出すると視認性は高まるが，Rとしてはこのようにするメリットはない</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># df2 &lt;- df2[, c("組合員別内訳", "都道府県", "年度", "unit", "value")]</span></span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>いよいよ <code>組合員別内訳</code> 列に何が入っているか確認します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(<span class="fu">data.frame</span>(df2[, <span class="st">"組合員別内訳"</span>]))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                  組合員別内訳
1                                      合計_計
790                                  合計_個人
1579                                 合計_団体
2368                               正組合員_計
3157                             正組合員_個人
3946                        正組合員_個人_女性
4735  正組合員_個人_組合員たる地位を失わない者
5015                             正組合員_法人
5351                正組合員_法人_農事組合法人
5687                  正組合員_法人_その他法人
6023                             正組合員_団体
6476                正組合員_団体_農事組合法人
6700                    正組合員_団体_株式会社
6924                    正組合員_団体_合名会社
7148                    正組合員_団体_合資会社
7372                              正組合員戸数
8161                               准組合員_計
8950                             准組合員_個人
9739                             准組合員_団体
10528               准組合員_団体_農業協同組合
10864               准組合員_団体_農事組合法人
11424                 准組合員_団体_その他団体
11760                   准組合員_団体_株式会社
11984                   准組合員_団体_合名会社
12208                   准組合員_団体_合資会社
12432                             准組合員戸数
13221             一戸複数正組合員制実施組合数</code></pre>
</div>
</div>
<p>ここで，この列が正組合員と准組合員といった分類であることが分かります。 念のため，ここで <code>unit</code> 列との対応を確認しておきます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">apply</span>(df2[, <span class="fu">c</span>(<span class="st">"組合員別内訳"</span>, <span class="st">"unit"</span>)], <span class="dv">1</span>, paste, <span class="at">collapse =</span> <span class="st">" "</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
          一戸複数正組合員制実施組合数 組合 
                                        789 
                                 合計_計 人 
                                        789 
                               合計_個人 人 
                                        789 
                               合計_団体 人 
                                        789 
                             准組合員_計 人 
                                        789 
                           准組合員_個人 人 
                                        789 
                           准組合員_団体 人 
                                        789 
                准組合員_団体_その他団体 人 
                                        336 
                  准組合員_団体_株式会社 人 
                                        224 
                  准組合員_団体_合資会社 人 
                                        224 
                  准組合員_団体_合名会社 人 
                                        224 
              准組合員_団体_農業協同組合 人 
                                        336 
              准組合員_団体_農事組合法人 人 
                                        560 
                            准組合員戸数 戸 
                                        789 
                             正組合員_計 人 
                                        789 
                           正組合員_個人 人 
                                        789 
                      正組合員_個人_女性 人 
                                        789 
正組合員_個人_組合員たる地位を失わない者 人 
                                        280 
                           正組合員_団体 人 
                                        453 
                  正組合員_団体_株式会社 人 
                                        224 
                  正組合員_団体_合資会社 人 
                                        224 
                  正組合員_団体_合名会社 人 
                                        224 
              正組合員_団体_農事組合法人 人 
                                        224 
                           正組合員_法人 人 
                                        336 
                正組合員_法人_その他法人 人 
                                        336 
              正組合員_法人_農事組合法人 人 
                                        336 
                            正組合員戸数 戸 
                                        789 </code></pre>
</div>
</div>
<p>法人も単位は <code>"人"</code> になっているようです。 <code>"組合"</code> と <code>"戸"</code> だけ注意すべきでしょう。</p>
<p>ここで，見栄えをよくするために，アンダーバーを括弧に変換しておきます。 これらの値が作図する際の凡例に表示されることがあるため，見栄えは重要です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _を（）に変換する（factorではない場合）</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>df2[, <span class="st">"組合員別内訳"</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(df2[, <span class="st">"組合員別内訳"</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>], <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">grep</span>(<span class="st">"_"</span>, x)) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">sub</span>(<span class="st">"_"</span>, <span class="st">"（"</span>, x), <span class="st">"）"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)}</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># _を2つ使っているケースに対応</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>df2[, <span class="st">"組合員別内訳"</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(df2[, <span class="st">"組合員別内訳"</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>], <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">grep</span>(<span class="st">"_"</span>, x)) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">sub</span>(<span class="st">"_"</span>, <span class="st">"（"</span>, x), <span class="st">"）"</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)}</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2[, <span class="st">"組合員別内訳"</span>])</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 1
   組合員別内訳                                  
   &lt;chr&gt;                                         
 1 合計（計）                                    
 2 合計（個人）                                  
 3 合計（団体）                                  
 4 正組合員（計）                                
 5 正組合員（個人）                              
 6 正組合員（個人（女性））                      
 7 正組合員（個人（組合員たる地位を失わない者））
 8 正組合員（法人）                              
 9 正組合員（法人（農事組合法人））              
10 正組合員（法人（その他法人））                
# ℹ 17 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>組合員別内訳 <span class="ot">&lt;-</span> <span class="fu">factor</span>(df2<span class="sc">$</span>組合員別内訳, <span class="at">levels =</span> <span class="fu">unique</span>(df2<span class="sc">$</span>組合員別内訳))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>最後に，全国のデータを抽出する。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> df2[df2<span class="sc">$</span>都道府県 <span class="sc">==</span> <span class="st">"全国"</span>, ]</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="作図" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="作図"><span class="header-section-number">3</span> 作図</h2>
<p>作図のためには，ここまでで整形したデータフレームから，作図に必要な行を抽出すればよいです。</p>
<section id="折れ線グラフの作図" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="折れ線グラフの作図"><span class="header-section-number">3.1</span> 折れ線グラフの作図</h3>
<p>まず，組合員の合計の折れ線グラフを描くことにしましょう。 必要なデータのみを抽出します。 <code>grep()</code> の最初の引数は正規表現です。 正規表現は初心者にはハードルが高いですが，慣れると非常に便利です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df3[<span class="fu">grep</span>(<span class="st">"^合計（計）$"</span>, df3<span class="sc">$</span>組合員別内訳), ]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df_JAmembers</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 10
   cat01_code 組合員別内訳 area_code 都道府県 time_code `時間軸（年度次）` unit 
   &lt;chr&gt;      &lt;fct&gt;        &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;              &lt;chr&gt;
 1 110        合計（計）   00000     全国     20161000… 2016年度           人   
 2 110        合計（計）   00000     全国     20151000… 2015年度           人   
 3 110        合計（計）   00000     全国     20141000… 2014年度           人   
 4 110        合計（計）   00000     全国     20131000… 2013年度           人   
 5 110        合計（計）   00000     全国     20121000… 2012年度           人   
 6 110        合計（計）   00000     全国     20111000… 2011年度           人   
 7 110        合計（計）   00000     全国     20101000… 2010年度           人   
 8 110        合計（計）   00000     全国     20091000… 2009年度           人   
 9 110        合計（計）   00000     全国     20081000… 2008年度           人   
10 110        合計（計）   00000     全国     20071000… 2007年度           人   
11 110        合計（計）   00000     全国     20061000… 2006年度           人   
12 110        合計（計）   00000     全国     20051000… 2005年度           人   
13 110        合計（計）   00000     全国     20041000… 2004年度           人   
14 110        合計（計）   00000     全国     20031000… 2003年度           人   
15 110        合計（計）   00000     全国     20021000… 2002年度           人   
16 110        合計（計）   00000     全国     20011000… 2001年度           人   
17 110        合計（計）   00000     全国     20001000… 2000年度           人   
18 110        合計（計）   00000     全国     19991000… 1999年度           人   
19 110        合計（計）   00000     全国     19981000… 1998年度           人   
# ℹ 3 more variables: value &lt;dbl&gt;, annotation &lt;chr&gt;, 年度 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>これは，tidyverseでは次のように書きます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
次のパッケージを付け加えます: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>以下のオブジェクトは 'package:stats' からマスクされています:

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>以下のオブジェクトは 'package:base' からマスクされています:

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df3 <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^合計（計）$"</span>, 組合員別内訳))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>df_JAmembers</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 10
   cat01_code 組合員別内訳 area_code 都道府県 time_code `時間軸（年度次）` unit 
   &lt;chr&gt;      &lt;fct&gt;        &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;              &lt;chr&gt;
 1 110        合計（計）   00000     全国     20161000… 2016年度           人   
 2 110        合計（計）   00000     全国     20151000… 2015年度           人   
 3 110        合計（計）   00000     全国     20141000… 2014年度           人   
 4 110        合計（計）   00000     全国     20131000… 2013年度           人   
 5 110        合計（計）   00000     全国     20121000… 2012年度           人   
 6 110        合計（計）   00000     全国     20111000… 2011年度           人   
 7 110        合計（計）   00000     全国     20101000… 2010年度           人   
 8 110        合計（計）   00000     全国     20091000… 2009年度           人   
 9 110        合計（計）   00000     全国     20081000… 2008年度           人   
10 110        合計（計）   00000     全国     20071000… 2007年度           人   
11 110        合計（計）   00000     全国     20061000… 2006年度           人   
12 110        合計（計）   00000     全国     20051000… 2005年度           人   
13 110        合計（計）   00000     全国     20041000… 2004年度           人   
14 110        合計（計）   00000     全国     20031000… 2003年度           人   
15 110        合計（計）   00000     全国     20021000… 2002年度           人   
16 110        合計（計）   00000     全国     20011000… 2001年度           人   
17 110        合計（計）   00000     全国     20001000… 2000年度           人   
18 110        合計（計）   00000     全国     19991000… 1999年度           人   
19 110        合計（計）   00000     全国     19981000… 1998年度           人   
# ℹ 3 more variables: value &lt;dbl&gt;, annotation &lt;chr&gt;, 年度 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>tidyverseの方が分かりやすいとの評判ですが，個人的にはどちらでも同じです。 tidyverseの方がコードが短くなることはよくあります。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsci)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>df_JAmembers<span class="sc">$</span>組合員別内訳 <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_JAmembers<span class="sc">$</span>組合員別内訳)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 組合員別内訳, <span class="at">colour =</span> 組合員別内訳)) <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員数"</span>) <span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の組合員数の推移"</span>) <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>組合員数が極端に増加しているように見えます。 これはこれで間違っていないが，気になるようなら，縦軸が0から始まるようにするとよいでしょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 組合員別内訳, <span class="at">colour =</span> 組合員別内訳)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員数"</span>) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の組合員数の推移"</span>) <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>続いて，正組合員と准組合員の折れ線グラフを描いてみます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df3[<span class="fu">grep</span>(<span class="st">"^正組合員（計）$|^准組合員（計）$"</span>, df3<span class="sc">$</span>組合員別内訳), ]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>df_JAmembers<span class="sc">$</span>組合員別内訳 <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_JAmembers<span class="sc">$</span>組合員別内訳)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 組合員別内訳, <span class="at">colour =</span> 組合員別内訳)) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6000000</span>, <span class="dv">1000000</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員数"</span>) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の組合員数の推移"</span>) <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>正組合員と准組合員が逆転する折れ線グラフが描けました。</p>
</section>
<section id="もっと作図" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="もっと作図"><span class="header-section-number">3.2</span> もっと作図</h3>
<p>次に，個人以外の組合員についても見ていきましょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df3[<span class="fu">grep</span>(<span class="st">"^正組合員（個人）$|^正組合員（法人）$|^正組合員（団体）$|^准組合員（個人）$|^准組合員（団体）$"</span>, df3<span class="sc">$</span>組合員別内訳), ]</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>df_JAmembers<span class="sc">$</span>組合員別内訳 <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_JAmembers<span class="sc">$</span>組合員別内訳)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 組合員別内訳, <span class="at">colour =</span> 組合員別内訳)) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員数"</span>) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の組合員数（個人，法人，団体）の推移"</span>) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"ja_members_kojin_dantai.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>正組合員（団体）のグラフが途中で消え，正組合員（法人）のグラフが途中から現れていることが気になります。 正組合員（団体）の値と正組合員（法人）の値が近いことから，統計の取り方が変わった可能性が考えられるでしょう。 そこで，元のデータで，正組合員（団体）が途中から欠損値になっているかどうかを確認してみます。 表を見る場合は，データをロングではなくワイドにした方が分かりやすいです。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>df3_wide <span class="ot">&lt;-</span> df3 <span class="sc">|&gt;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> 年度, <span class="at">names_from =</span> 組合員別内訳, <span class="at">values_from =</span> value)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(df3_wide, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 1%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">年度</th>
<th style="text-align: right;">合計（計）</th>
<th style="text-align: right;">合計（個人）</th>
<th style="text-align: right;">合計（団体）</th>
<th style="text-align: right;">正組合員（計）</th>
<th style="text-align: right;">正組合員（個人）</th>
<th style="text-align: right;">正組合員（個人（女性））</th>
<th style="text-align: right;">正組合員（個人（組合員たる地位を失わない者））</th>
<th style="text-align: right;">正組合員（法人）</th>
<th style="text-align: right;">正組合員（法人（農事組合法人））</th>
<th style="text-align: right;">正組合員（法人（その他法人））</th>
<th style="text-align: right;">正組合員（団体）</th>
<th style="text-align: right;">正組合員（団体（農事組合法人））</th>
<th style="text-align: right;">正組合員（団体（株式会社））</th>
<th style="text-align: right;">正組合員（団体（合名会社））</th>
<th style="text-align: right;">正組合員（団体（合資会社））</th>
<th style="text-align: right;">正組合員戸数</th>
<th style="text-align: right;">准組合員（計）</th>
<th style="text-align: right;">准組合員（個人）</th>
<th style="text-align: right;">准組合員（団体）</th>
<th style="text-align: right;">准組合員（団体（農業協同組合））</th>
<th style="text-align: right;">准組合員（団体（農事組合法人））</th>
<th style="text-align: right;">准組合員（団体（その他団体））</th>
<th style="text-align: right;">准組合員（団体（株式会社））</th>
<th style="text-align: right;">准組合員（団体（合名会社））</th>
<th style="text-align: right;">准組合員（団体（合資会社））</th>
<th style="text-align: right;">准組合員戸数</th>
<th style="text-align: right;">一戸複数正組合員制実施組合数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2,016</td>
<td style="text-align: right;">10,444,426</td>
<td style="text-align: right;">10,346,202</td>
<td style="text-align: right;">98,224</td>
<td style="text-align: right;">4,367,858</td>
<td style="text-align: right;">4,348,560</td>
<td style="text-align: right;">939,283</td>
<td style="text-align: right;">813</td>
<td style="text-align: right;">19,298</td>
<td style="text-align: right;">6,234</td>
<td style="text-align: right;">13,064</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,707,401</td>
<td style="text-align: right;">6,076,568</td>
<td style="text-align: right;">5,997,642</td>
<td style="text-align: right;">78,926</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">2,839</td>
<td style="text-align: right;">75,892</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,901,662</td>
<td style="text-align: right;">633</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,015</td>
<td style="text-align: right;">10,370,172</td>
<td style="text-align: right;">10,272,942</td>
<td style="text-align: right;">97,230</td>
<td style="text-align: right;">4,433,389</td>
<td style="text-align: right;">4,415,549</td>
<td style="text-align: right;">937,145</td>
<td style="text-align: right;">838</td>
<td style="text-align: right;">17,840</td>
<td style="text-align: right;">5,656</td>
<td style="text-align: right;">12,184</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,770,762</td>
<td style="text-align: right;">5,936,783</td>
<td style="text-align: right;">5,857,393</td>
<td style="text-align: right;">79,390</td>
<td style="text-align: right;">258</td>
<td style="text-align: right;">2,476</td>
<td style="text-align: right;">76,656</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,813,905</td>
<td style="text-align: right;">653</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,014</td>
<td style="text-align: right;">10,267,614</td>
<td style="text-align: right;">10,171,350</td>
<td style="text-align: right;">96,264</td>
<td style="text-align: right;">4,495,106</td>
<td style="text-align: right;">4,478,620</td>
<td style="text-align: right;">932,121</td>
<td style="text-align: right;">945</td>
<td style="text-align: right;">16,486</td>
<td style="text-align: right;">5,035</td>
<td style="text-align: right;">11,451</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,818,148</td>
<td style="text-align: right;">5,772,508</td>
<td style="text-align: right;">5,692,730</td>
<td style="text-align: right;">79,778</td>
<td style="text-align: right;">218</td>
<td style="text-align: right;">2,564</td>
<td style="text-align: right;">76,996</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,685,872</td>
<td style="text-align: right;">657</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,013</td>
<td style="text-align: right;">10,145,363</td>
<td style="text-align: right;">10,049,996</td>
<td style="text-align: right;">95,367</td>
<td style="text-align: right;">4,561,504</td>
<td style="text-align: right;">4,546,050</td>
<td style="text-align: right;">928,584</td>
<td style="text-align: right;">1,056</td>
<td style="text-align: right;">15,454</td>
<td style="text-align: right;">4,729</td>
<td style="text-align: right;">10,725</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,896,532</td>
<td style="text-align: right;">5,583,859</td>
<td style="text-align: right;">5,503,946</td>
<td style="text-align: right;">79,913</td>
<td style="text-align: right;">223</td>
<td style="text-align: right;">2,617</td>
<td style="text-align: right;">77,073</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,556,467</td>
<td style="text-align: right;">677</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,012</td>
<td style="text-align: right;">9,977,967</td>
<td style="text-align: right;">9,883,694</td>
<td style="text-align: right;">94,273</td>
<td style="text-align: right;">4,614,306</td>
<td style="text-align: right;">4,599,727</td>
<td style="text-align: right;">917,488</td>
<td style="text-align: right;">1,297</td>
<td style="text-align: right;">14,579</td>
<td style="text-align: right;">4,413</td>
<td style="text-align: right;">10,166</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,939,700</td>
<td style="text-align: right;">5,363,661</td>
<td style="text-align: right;">5,283,967</td>
<td style="text-align: right;">79,694</td>
<td style="text-align: right;">252</td>
<td style="text-align: right;">2,812</td>
<td style="text-align: right;">76,617</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,354,676</td>
<td style="text-align: right;">679</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,011</td>
<td style="text-align: right;">9,834,031</td>
<td style="text-align: right;">9,740,311</td>
<td style="text-align: right;">93,720</td>
<td style="text-align: right;">4,668,961</td>
<td style="text-align: right;">4,655,215</td>
<td style="text-align: right;">907,486</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">13,746</td>
<td style="text-align: right;">4,308</td>
<td style="text-align: right;">9,438</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,007,419</td>
<td style="text-align: right;">5,165,070</td>
<td style="text-align: right;">5,085,096</td>
<td style="text-align: right;">79,974</td>
<td style="text-align: right;">236</td>
<td style="text-align: right;">2,945</td>
<td style="text-align: right;">76,793</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,195,486</td>
<td style="text-align: right;">691</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,010</td>
<td style="text-align: right;">9,693,855</td>
<td style="text-align: right;">9,600,185</td>
<td style="text-align: right;">93,670</td>
<td style="text-align: right;">4,720,274</td>
<td style="text-align: right;">4,707,348</td>
<td style="text-align: right;">890,718</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">12,926</td>
<td style="text-align: right;">4,172</td>
<td style="text-align: right;">3,892</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">4,068,269</td>
<td style="text-align: right;">4,973,581</td>
<td style="text-align: right;">4,892,837</td>
<td style="text-align: right;">80,744</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,898</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">15,532</td>
<td style="text-align: right;">379</td>
<td style="text-align: right;">476</td>
<td style="text-align: right;">4,060,925</td>
<td style="text-align: right;">694</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,009</td>
<td style="text-align: right;">9,579,441</td>
<td style="text-align: right;">9,488,013</td>
<td style="text-align: right;">91,428</td>
<td style="text-align: right;">4,775,204</td>
<td style="text-align: right;">4,762,961</td>
<td style="text-align: right;">881,294</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">12,243</td>
<td style="text-align: right;">4,027</td>
<td style="text-align: right;">3,272</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">4,127,031</td>
<td style="text-align: right;">4,804,237</td>
<td style="text-align: right;">4,725,052</td>
<td style="text-align: right;">79,185</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,148</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">13,665</td>
<td style="text-align: right;">441</td>
<td style="text-align: right;">570</td>
<td style="text-align: right;">3,931,565</td>
<td style="text-align: right;">706</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,008</td>
<td style="text-align: right;">9,494,334</td>
<td style="text-align: right;">9,401,968</td>
<td style="text-align: right;">92,366</td>
<td style="text-align: right;">4,828,192</td>
<td style="text-align: right;">4,816,570</td>
<td style="text-align: right;">872,402</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">11,622</td>
<td style="text-align: right;">3,976</td>
<td style="text-align: right;">3,108</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">4,184,898</td>
<td style="text-align: right;">4,666,142</td>
<td style="text-align: right;">4,585,398</td>
<td style="text-align: right;">80,744</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,842</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">12,216</td>
<td style="text-align: right;">404</td>
<td style="text-align: right;">667</td>
<td style="text-align: right;">3,824,465</td>
<td style="text-align: right;">727</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,007</td>
<td style="text-align: right;">9,432,809</td>
<td style="text-align: right;">9,343,691</td>
<td style="text-align: right;">89,118</td>
<td style="text-align: right;">4,888,449</td>
<td style="text-align: right;">4,877,364</td>
<td style="text-align: right;">853,238</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">11,085</td>
<td style="text-align: right;">3,955</td>
<td style="text-align: right;">3,071</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">4,242,450</td>
<td style="text-align: right;">4,544,360</td>
<td style="text-align: right;">4,466,327</td>
<td style="text-align: right;">78,033</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">5,244</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">12,118</td>
<td style="text-align: right;">409</td>
<td style="text-align: right;">506</td>
<td style="text-align: right;">3,719,601</td>
<td style="text-align: right;">770</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,006</td>
<td style="text-align: right;">9,322,431</td>
<td style="text-align: right;">9,234,138</td>
<td style="text-align: right;">88,293</td>
<td style="text-align: right;">4,942,200</td>
<td style="text-align: right;">4,931,853</td>
<td style="text-align: right;">812,508</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">10,347</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,294,622</td>
<td style="text-align: right;">4,380,231</td>
<td style="text-align: right;">4,302,285</td>
<td style="text-align: right;">77,946</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,603,866</td>
<td style="text-align: right;">799</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,005</td>
<td style="text-align: right;">9,188,153</td>
<td style="text-align: right;">9,101,310</td>
<td style="text-align: right;">86,843</td>
<td style="text-align: right;">4,997,797</td>
<td style="text-align: right;">4,988,029</td>
<td style="text-align: right;">804,583</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">9,768</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,349,898</td>
<td style="text-align: right;">4,190,356</td>
<td style="text-align: right;">4,113,281</td>
<td style="text-align: right;">77,075</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,443,602</td>
<td style="text-align: right;">840</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,004</td>
<td style="text-align: right;">9,145,856</td>
<td style="text-align: right;">9,059,342</td>
<td style="text-align: right;">86,514</td>
<td style="text-align: right;">5,054,943</td>
<td style="text-align: right;">5,045,472</td>
<td style="text-align: right;">786,357</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">9,471</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,397,013</td>
<td style="text-align: right;">4,090,913</td>
<td style="text-align: right;">4,013,870</td>
<td style="text-align: right;">77,043</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,349,944</td>
<td style="text-align: right;">860</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,003</td>
<td style="text-align: right;">9,100,072</td>
<td style="text-align: right;">9,013,949</td>
<td style="text-align: right;">86,123</td>
<td style="text-align: right;">5,107,942</td>
<td style="text-align: right;">5,098,862</td>
<td style="text-align: right;">787,965</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">9,080</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,444,800</td>
<td style="text-align: right;">3,992,130</td>
<td style="text-align: right;">3,915,087</td>
<td style="text-align: right;">77,043</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,270,872</td>
<td style="text-align: right;">891</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,002</td>
<td style="text-align: right;">9,071,894</td>
<td style="text-align: right;">8,986,018</td>
<td style="text-align: right;">85,876</td>
<td style="text-align: right;">5,158,762</td>
<td style="text-align: right;">5,149,940</td>
<td style="text-align: right;">783,806</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8,822</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,495,922</td>
<td style="text-align: right;">3,913,132</td>
<td style="text-align: right;">3,836,078</td>
<td style="text-align: right;">77,054</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,193,309</td>
<td style="text-align: right;">966</td>
</tr>
<tr class="even">
<td style="text-align: right;">2,001</td>
<td style="text-align: right;">9,082,535</td>
<td style="text-align: right;">8,997,213</td>
<td style="text-align: right;">85,322</td>
<td style="text-align: right;">5,211,211</td>
<td style="text-align: right;">5,202,171</td>
<td style="text-align: right;">769,748</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">9,040</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,540,713</td>
<td style="text-align: right;">3,871,324</td>
<td style="text-align: right;">3,795,042</td>
<td style="text-align: right;">76,282</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,168,465</td>
<td style="text-align: right;">1,082</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2,000</td>
<td style="text-align: right;">9,108,596</td>
<td style="text-align: right;">9,024,008</td>
<td style="text-align: right;">84,588</td>
<td style="text-align: right;">5,249,499</td>
<td style="text-align: right;">5,240,785</td>
<td style="text-align: right;">746,719</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8,714</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,573,809</td>
<td style="text-align: right;">3,859,097</td>
<td style="text-align: right;">3,783,223</td>
<td style="text-align: right;">75,874</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,163,107</td>
<td style="text-align: right;">1,274</td>
</tr>
<tr class="even">
<td style="text-align: right;">1,999</td>
<td style="text-align: right;">9,125,267</td>
<td style="text-align: right;">9,041,646</td>
<td style="text-align: right;">83,621</td>
<td style="text-align: right;">5,296,252</td>
<td style="text-align: right;">5,287,799</td>
<td style="text-align: right;">739,550</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8,453</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,615,721</td>
<td style="text-align: right;">3,829,015</td>
<td style="text-align: right;">3,753,847</td>
<td style="text-align: right;">75,168</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,141,118</td>
<td style="text-align: right;">1,446</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1,998</td>
<td style="text-align: right;">9,128,476</td>
<td style="text-align: right;">9,044,906</td>
<td style="text-align: right;">83,570</td>
<td style="text-align: right;">5,344,203</td>
<td style="text-align: right;">5,335,636</td>
<td style="text-align: right;">734,003</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8,567</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4,651,702</td>
<td style="text-align: right;">3,784,273</td>
<td style="text-align: right;">3,709,270</td>
<td style="text-align: right;">75,003</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3,101,037</td>
<td style="text-align: right;">1,620</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>予想どおりのデータです。 ちなみに，年度のコンマは不要ですが，消し方が分からないため，表示されてしまいます。</p>
</section>
<section id="もっともっと作図" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="もっともっと作図"><span class="header-section-number">3.3</span> もっともっと作図</h3>
<p>次に，授業では女性の組合員が増えていることを説明しました。 このことを実際のデータで確認してみましょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df3[<span class="fu">grep</span>(<span class="st">"^正組合員（個人（女性））$"</span>, df3<span class="sc">$</span>組合員別内訳), ]</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>df_JAmembers<span class="sc">$</span>組合員別内訳 <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_JAmembers<span class="sc">$</span>組合員別内訳)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 組合員別内訳, <span class="at">colour =</span> 組合員別内訳)) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員数"</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の組合員数（女性）の推移"</span>) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">85</span>, .<span class="dv">15</span>),</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>)) <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"ja_members_female.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>確かに女性の組合員は増加していることが分かります。 ただし，これだと組合員全体に占める女性の比率が分からないので，上述のグラフと重ねたグラフを描いてみます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df3[<span class="fu">grep</span>(<span class="st">"^正組合員（個人（女性））$|^正組合員（計）$|^准組合員（計）$"</span>, df3<span class="sc">$</span>組合員別内訳), ]</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>df_JAmembers<span class="sc">$</span>組合員別内訳 <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_JAmembers<span class="sc">$</span>組合員別内訳)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 組合員別内訳, <span class="at">colour =</span> 組合員別内訳)) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員数"</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の組合員数の推移"</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"ja_members_female_with_all.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>正組合員全体が減少している中で，女性が増加していることが1つのグラフでわかります。</p>
<p>女性の増加に焦点を当てたければ，女性比率を計算するとよいかもしれません。 ここで，法人と団体は除いて計算することに気をつけましょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df3[<span class="fu">grep</span>(<span class="st">"^正組合員（個人（女性））$|^正組合員（個人）$"</span>, df3<span class="sc">$</span>組合員別内訳), ]</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df_JAmembers <span class="sc">|&gt;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> 年度, <span class="at">names_from =</span> 組合員別内訳, <span class="at">values_from =</span> value)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>df_JAmembers<span class="sc">$</span>女性比率 <span class="ot">&lt;-</span> df_JAmembers<span class="sc">$</span><span class="st">`</span><span class="at">正組合員（個人（女性））</span><span class="st">`</span> <span class="sc">/</span> df_JAmembers<span class="sc">$</span><span class="st">`</span><span class="at">正組合員（個人）</span><span class="st">`</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> 女性比率)) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">name =</span> <span class="st">"女性比率"</span>) <span class="sc">+</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の正組合員に占める女性比率の推移"</span>) <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"ja_members_female_ratio.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>凡例がなく，線と点の色が黒くなりました。 ここで描画に用いているデータフレームはワイドです。 <code>ggplot2</code> で凡例を付け，色分けするためには，<code>group</code> を使わなければならず，そのためにはデータをワイドではなくロングにする必要があります。 ロングにしたときの1つの列を <code>group</code> と <code>colour</code> に書くとよいです。</p>
<p>組合員戸数の推移はどうでしょうか。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df3[<span class="fu">grep</span>(<span class="st">"^正組合員戸数$|^准組合員戸数$"</span>, df3<span class="sc">$</span>組合員別内訳), ]</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>df_JAmembers<span class="sc">$</span>組合員別内訳 <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_JAmembers<span class="sc">$</span>組合員別内訳)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 組合員別内訳, <span class="at">colour =</span> 組合員別内訳)) <span class="sc">+</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員戸数"</span>) <span class="sc">+</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の組合員戸数の推移"</span>) <span class="sc">+</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"ja_members_household.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ここで扱っているのデータには，一戸複数正組合員制実施組合数の値も含まれています。 授業を踏まえると，この組合数は減少している可能性が考えられます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df3[<span class="fu">grep</span>(<span class="st">"^一戸複数正組合員制実施組合数$"</span>, df3<span class="sc">$</span>組合員別内訳), ]</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 組合員別内訳, <span class="at">colour =</span> 組合員別内訳)) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合数"</span>) <span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"一戸複数正組合員制実施組合数の推移"</span>) <span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"number_of_ja_multiple_members_per_household.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>実際にグラフを作成すると，一戸複数正組合員制実施組合数の現象が確認できます。 ただし，農業協同組合の数が減少しているため，この数値の解釈には注意が必要です。</p>
<p>正組合員（個人（組合員たる地位を失わない者））は何でしょうか。 授業を踏まえると，これは土地持ち非農家の数を反映したものかもしれません。 定義については，統計データではなく，別の方法で調べます。 例えば，以下のような資料があります。</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
農林水産省「農地を所有している非農家の組合員資格保有という農協法の理念に違反している状況の解消」2012年1月
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://www.cao.go.jp/sasshin/kisei-seido/meeting/2012/togi/agri/121127/item1.pdf" target="_blank">https://www.cao.go.jp/sasshin/kisei-seido/meeting/2012/togi/agri/121127/item1.pdf</a></p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df3[<span class="fu">grep</span>(<span class="st">"^正組合員（個人（組合員たる地位を失わない者））$"</span>, df3<span class="sc">$</span>組合員別内訳), ]</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 組合員別内訳, <span class="at">colour =</span> 組合員別内訳)) <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員数"</span>) <span class="sc">+</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"正組合員（個人（組合員たる地位を失わない者））"</span>) <span class="sc">+</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"ja_members_nonfarmer.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="都道府県別の作図" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="都道府県別の作図"><span class="header-section-number">4</span> 都道府県別の作図</h2>
<p>データフレーム <code>df2</code> から <code>df2$都道府県 == "全国"</code> という条件で抽出したデータに基づいて全国のデータの図を描いたことから，<code>df2$都道府県 != "全国"</code> を抽出すれば都道府県のデータが得られると考えられるかもしれません。 確認してみます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2<span class="sc">$</span>都道府県[df2<span class="sc">$</span>都道府県 <span class="sc">!=</span> <span class="st">"全国"</span>])</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "1組合当たり"     "北海道"          "東北_小計"       "青森県"         
 [5] "岩手県"          "宮城県"          "秋田県"          "山形県"         
 [9] "福島県"          "関東_小計"       "茨城県"          "栃木県"         
[13] "群馬県"          "埼玉県"          "千葉県"          "東京都"         
[17] "神奈川県"        "山梨県"          "長野県"          "静岡県"         
[21] "北陸_小計"       "新潟県"          "富山県"          "石川県"         
[25] "福井県"          "東海_小計"       "岐阜県"          "愛知県"         
[29] "三重県"          "近畿_小計"       "滋賀県"          "京都府"         
[33] "大阪府"          "兵庫県"          "奈良県"          "和歌山県"       
[37] "中国・四国_小計" "鳥取県"          "島根県"          "岡山県"         
[41] "広島県"          "山口県"          "徳島県"          "香川県"         
[45] "愛媛県"          "高知県"          "九州_小計"       "福岡県"         
[49] "佐賀県"          "長崎県"          "熊本県"          "大分県"         
[53] "宮崎県"          "鹿児島県"        "沖縄県"         </code></pre>
</div>
</div>
<p>都道府県以外を1つずつ取り除いていく必要があります。 このとき，<code>grepl()</code> の正規表現の中に異なる条件を書くのが手っ取り早いです。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df2<span class="sc">$</span>都道府県[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"全国|小計|組合"</span>, df2<span class="sc">$</span>都道府県)])</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "北海道"   "青森県"   "岩手県"   "宮城県"   "秋田県"   "山形県"  
 [7] "福島県"   "茨城県"   "栃木県"   "群馬県"   "埼玉県"   "千葉県"  
[13] "東京都"   "神奈川県" "山梨県"   "長野県"   "静岡県"   "新潟県"  
[19] "富山県"   "石川県"   "福井県"   "岐阜県"   "愛知県"   "三重県"  
[25] "滋賀県"   "京都府"   "大阪府"   "兵庫県"   "奈良県"   "和歌山県"
[31] "鳥取県"   "島根県"   "岡山県"   "広島県"   "山口県"   "徳島県"  
[37] "香川県"   "愛媛県"   "高知県"   "福岡県"   "佐賀県"   "長崎県"  
[43] "熊本県"   "大分県"   "宮崎県"   "鹿児島県" "沖縄県"  </code></pre>
</div>
</div>
<p><code>grep()</code> と <code>grepl()</code> の違いに注意しましょう。 都道府県のみ抽出されていることが確認できたら，実際にデータにこの抽出条件を用います。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>df_pref <span class="ot">&lt;-</span> df2[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"全国|小計|組合"</span>, df2<span class="sc">$</span>都道府県), ]</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>図の描き方は全国の場合とまったく同じです。 ただし，47本の折れ線グラフは判別しにくいため，特徴のあるものだけにラベルを表示するとよいでしょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghighlight)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df_pref <span class="sc">|&gt;</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^合計（計）$"</span>, 組合員別内訳))</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>df_JAmembers<span class="sc">$</span>組合員別内訳 <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_JAmembers<span class="sc">$</span>組合員別内訳)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 都道府県, <span class="at">colour =</span> 都道府県)) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gghighlight</span>(<span class="fu">max</span>(value) <span class="sc">&gt;</span> <span class="dv">400000</span> <span class="sc">|</span> <span class="fu">min</span>(value) <span class="sc">&lt;</span> <span class="dv">100000</span>) <span class="sc">+</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="co"># gghighlight(grepl("愛媛県", df_JAmembers$都道府県)) +</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員数"</span>) <span class="sc">+</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の組合員数の推移（都道府県別）"</span>) <span class="sc">+</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"ja_members_pref.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>続いて，正組合員の折れ線グラフを描いてみます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df_pref <span class="sc">|&gt;</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(組合員別内訳 <span class="sc">==</span> <span class="st">"正組合員（計）"</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 都道府県, <span class="at">colour =</span> 都道府県)) <span class="sc">+</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gghighlight</span>(<span class="fu">max</span>(value) <span class="sc">&gt;</span> <span class="dv">200000</span> <span class="sc">|</span> <span class="fu">min</span>(value) <span class="sc">&lt;</span> <span class="dv">52000</span>) <span class="sc">+</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員数"</span>) <span class="sc">+</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の正組合員数の推移（都道府県別）"</span>) <span class="sc">+</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"ja_members_sei_pref.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>准組合員の折れ線グラフを描いてみます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df_pref <span class="sc">|&gt;</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(組合員別内訳 <span class="sc">==</span> <span class="st">"准組合員（計）"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> value, <span class="at">group =</span> 都道府県, <span class="at">colour =</span> 都道府県)) <span class="sc">+</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gghighlight</span>(<span class="fu">max</span>(value) <span class="sc">&gt;</span> <span class="dv">260000</span> <span class="sc">|</span> <span class="fu">min</span>(value) <span class="sc">&lt;</span> <span class="dv">30000</span>) <span class="sc">+</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>(), <span class="at">name =</span> <span class="st">"組合員数"</span>) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の准組合員数の推移（都道府県別）"</span>) <span class="sc">+</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"ja_members_jun_pref.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>女性比率の高い都道府県と低い都道府県はどこでしょうか。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df_pref[<span class="fu">grep</span>(<span class="st">"^正組合員（個人（女性））$|^正組合員（個人）$"</span>, df_pref<span class="sc">$</span>組合員別内訳), ]</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>df_JAmembers <span class="ot">&lt;-</span> df_JAmembers <span class="sc">|&gt;</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(都道府県, 年度), <span class="at">names_from =</span> 組合員別内訳, <span class="at">values_from =</span> value)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>df_JAmembers<span class="sc">$</span>女性比率 <span class="ot">&lt;-</span> df_JAmembers<span class="sc">$</span><span class="st">`</span><span class="at">正組合員（個人（女性））</span><span class="st">`</span> <span class="sc">/</span> df_JAmembers<span class="sc">$</span><span class="st">`</span><span class="at">正組合員（個人）</span><span class="st">`</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df_JAmembers, <span class="fu">aes</span>(<span class="at">x =</span> 年度, <span class="at">y =</span> 女性比率, <span class="at">group =</span> 都道府県, <span class="at">colour =</span> 都道府県)) <span class="sc">+</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gghighlight</span>(<span class="fu">max</span>(女性比率) <span class="sc">&gt;</span> .<span class="dv">3</span> <span class="sc">|</span> <span class="fu">min</span>(女性比率) <span class="sc">&lt;</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"農業協同組合の正組合員に占める女性比率の推移（都道府県別）"</span>) <span class="sc">+</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"出所：農林水産省『農業協同組合及び同連合会一斉調査 確報 総合農協統計表』</span><span class="sc">\n</span><span class="st">（https://www.e-stat.go.jp/dbview?sid=0003406360）"</span>) <span class="sc">+</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_d3</span>()</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraKakuProN-W3"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_data_formatting_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> <span class="st">"ja_members_female_ratio_pref.pdf"</span>, <span class="at">plot =</span> g, <span class="at">path =</span> outdir, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "コピーしました");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "コピーしました");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>